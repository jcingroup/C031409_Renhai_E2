(function(){var n=angular.module("angularFileUpload",[]);n.service("$upload",["$http","$timeout",function(n,t){function i(i){i.method=i.method||"POST";i.headers=i.headers||{};i.transformRequest=i.transformRequest||function(t,i){return window.ArrayBuffer&&t instanceof window.ArrayBuffer?t:n.defaults.transformRequest[0](t,i)};window.XMLHttpRequest.__isShim&&(i.headers.__setXHR_=function(){return function(n){i.__XHR=n;i.xhrFn&&i.xhrFn(n);n.upload.addEventListener("progress",function(n){i.progress&&t(function(){i.progress&&i.progress(n)})},!1);n.upload.addEventListener("load",function(n){n.lengthComputable&&t(function(){i.progress&&i.progress(n)})},!1)}});var r=n(i);return r.progress=function(n){return i.progress=n,r},r.abort=function(){return i.__XHR&&t(function(){i.__XHR.abort()}),r},r.xhr=function(n){return i.xhrFn=n,r},r.then=function(n,t){return function(r,u,f){i.progress=f||i.progress;var e=t.apply(n,[r,u,f]);return e.abort=n.abort,e.progress=n.progress,e.xhr=n.xhr,e}}(r,r.then),r}this.upload=function(t){t.headers=t.headers||{};t.headers["Content-Type"]=undefined;t.transformRequest=t.transformRequest||n.defaults.transformRequest;var f=new FormData,u=t.transformRequest,r=t.data;return t.transformRequest=function(n,i){var o,e,h,s,c,f;if(r)if(t.formDataAppender)for(o in r)e=r[o],t.formDataAppender(n,o,e);else for(o in r){if(e=r[o],typeof u=="function")e=u(e,i);else for(f=0;f<u.length;f++)h=u[f],typeof h=="function"&&(e=h(e,i));n.append(o,e)}if(t.file!=null)if(s=t.fileFormDataName||"file",Object.prototype.toString.call(t.file)==="[object Array]")for(c=Object.prototype.toString.call(s)==="[object String]",f=0;f<t.file.length;f++)n.append(c?s+f:s[f],t.file[f],t.file[f].name);else n.append(s,t.file,t.file.name);return n},t.data=f,i(t)};this.http=function(n){return i(n)}}]);n.directive("ngFileSelect",["$parse","$timeout",function(n,t){return function(i,r,u){var f=n(u.ngFileSelect);r.bind("change",function(n){var e=[],r,u;if(r=n.target.files,r!=null)for(u=0;u<r.length;u++)e.push(r.item(u));t(function(){f(i,{$files:e,$event:n})})});r.bind("click",function(){this.value=null})}}]);n.directive("ngFileDropAvailable",["$parse","$timeout",function(n,t){return function(i,r,u){if("draggable"in document.createElement("span")){var f=n(u.ngFileDropAvailable);t(function(){f(i)})}}}]);n.directive("ngFileDrop",["$parse","$timeout",function(n,t){return function(i,r,u){var e,o,f;if("draggable"in document.createElement("span")){e=null;o=n(u.ngFileDrop);r[0].addEventListener("dragover",function(n){t.cancel(e);n.stopPropagation();n.preventDefault();r.addClass(u.ngFileDragOverClass||"dragover")},!1);r[0].addEventListener("dragleave",function(){e=t(function(){r.removeClass(u.ngFileDragOverClass||"dragover")})},!1);f=0;function s(n,t){if(t.isDirectory){var i=t.createReader();f++;i.readEntries(function(t){for(var i=0;i<t.length;i++)s(n,t[i]);f--})}else f++,t.file(function(t){f--;n.push(t)})}r[0].addEventListener("drop",function(n){var c,h,l,e;if(n.stopPropagation(),n.preventDefault(),r.removeClass(u.ngFileDragOverClass||"dragover"),c=[],h=n.dataTransfer.items,h&&h.length>0&&h[0].webkitGetAsEntry)for(e=0;e<h.length;e++)s(c,h[e].webkitGetAsEntry());else if(l=n.dataTransfer.files,l!=null)for(e=0;e<l.length;e++)c.push(l.item(e));(function a(r){t(function(){f?a(10):o(i,{$files:c,$event:n})},r||0)})()},!1)}}}])})();